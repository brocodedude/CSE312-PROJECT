<!DOCTYPE html>
<html lang="en">
<head>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.60.0/dist/phaser-arcade-physics.min.js"></script>
    <title>Lets play a game</title>
</head>
<body>
<script>
    // main game
    let playerSprites = {'pac': null, 'gh1': null, 'gh2': null, 'gh3': null}
    let stars;
    let platforms;
    let cursors;

    const config = {
        type: Phaser.AUTO,
        width: window.innerWidth,
        height: window.innerHeight,
        backgroundColor: 0x000000,
        physics: {
            default: 'arcade',
            arcade: {
                gravity: 0,
                debug: true
            }
        },
        scale: {
            mode: Phaser.Scale.FIT,
            autoCenter: Phaser.Scale.CENTER_BOTH,
            parent: 'thegame'

        },
        scene: {
            preload: preload,
            create: create,
            update: update
        }
    };

    const game = new Phaser.Game(config);

    var player;
    var player2;


    function preload() {
        this.load.image("tileImage1", "assets/firstTile.png");
        this.load.image("tileImage2", "assets/secondTile.png");
        this.load.image("tileImage3", "assets/thirdTile.png");
        this.load.image("tileImage4", "assets/forthTile.png");
        this.load.image("pointImage", "assets/point.png");
        this.load.image("power-up", "assets/power-up.png");
        this.load.image("logo", "assets/Pac-Man_title.png");
        this.load.image("door", "assets/doorTile.png");
        this.load.image("blueDot", "assets/blueDot.png");
        this.load.image("frightened", "assets/frightened.png");
        this.load.image("GameoverBackground", "assets/gameoverBackground.png")
        this.load.image("GameoverButton", "assets/gameoverButton.png")
        // sprite sheets
        this.load.spritesheet("pacman", "assets/pacmanSpriteSheet.png", {
            frameWidth: 50,
            frameHeight: 50,
        });
        this.load.spritesheet("ghosts", "assets/ghosts.png", {
            frameWidth: 50,
            frameHeight: 50,
        });
        this.load.spritesheet("fruits", "assets/fruits.png", {
            frameWidth: 50,
            frameHeight: 50,
        });
    }

    function pacmanAnimInit(ctx) {
        let namesArray = [
            'pacmanEastAnim',
            'pacmanNorthAnim',
            'pacmanSouthAnim',
            'pacmanWestAnim',
        ]
        let indexArray = 0
        for (let i = 0; i < 12; i += 3) {
            ctx.anims.create({
                frames: ctx.anims.generateFrameNumbers('pacman', {start: i + 1, end: i + 3}),
                key: namesArray[indexArray],
                frameRate: 10,
                repeat: -1
            });
            indexArray++
        }

        // neutral pacman
        ctx.anims.create({
            frames: ctx.anims.generateFrameNumbers('pacman', {start: 0, end: 0}),
            key: 'neutralPacman',
            frameRate: 1,
            repeat: -1
        });

    }



    function ghostsAnimInit(ctx) {
        let namesArray = [
            'ghostRedEast',
            'ghostRedNorth',
            'ghostRedSouth',
            'ghostRedWest',
            'ghostBlueEast',
            'ghostBlueNorth',
            'ghostBlueSouth',
            'ghostBlueWest',
            'ghostPinkEast',
            'ghostPinkNorth',
            'ghostPinkSouth',
            'ghostPinkWest',
            'ghostOrangeEast',
            'ghostOrangeNorth',
            'ghostOrangeSouth',
            'ghostOrangeWest',
            'frigthenedAnim',
        ]
        for (let i = 0; i < namesArray.length; i++) {
            ctx.anims.create({
                frames: ctx.anims.generateFrameNumbers('ghosts', {start: i, end: i}),
                key: namesArray[i],
            })
        }
    }

    function create() {
        // Create a black rectangle to fill the screen
        const graphics = this.add.graphics();
        graphics.fillStyle(0x000000, 1); // Black color
        graphics.fillRect(0, 0, config.width, config.height);

        cursors = this.input.keyboard.createCursorKeys();


        // Create purple borders
        const borderThickness = 10;
        const borderGraphics = this.add.graphics();
        borderGraphics.lineStyle(borderThickness, 0x800080, 1); // Purple color
        borderGraphics.strokeRect(borderThickness / 2, borderThickness / 2, config.width - borderThickness, config.height - borderThickness);

        // create animations
        pacmanAnimInit(this)
        ghostsAnimInit(this)

        // create pacman
        player = this.physics.add.sprite(100, 450, 'ghosts');
        player.anims.play('ghostBlueNorth');

        player.setOrigin(0.5);
        player.setCollideWorldBounds(true);

        // // create ghosts
        // player2 = this.physics.add.sprite(100, 300, 'pacman');
        //
        // player2.setOrigin(0.5);
        // player2.setCollideWorldBounds(true);
    }

    function update() {

        // let currentAnim = 'neutralPacman'
        //
        // if (cursors.left.isDown) {
        //     player.setVelocityX(-160);
        //     // player2.setVelocityX(-160);
        //     currentAnim = 'pacmanWestAnim'
        //     player.anims.play(currentAnim, true);
        //
        //     // player2.anims.play('pac',true);
        // } else if (cursors.right.isDown) {
        //     player.setVelocityX(160);
        //     currentAnim = 'pacmanEastAnim'
        //     player.anims.play(currentAnim, true);
        //     // player2.setVelocityX(160);
        //
        //     // player2.anims.play('pac',true);
        //     // player.anims.play('move', true);
        // } else {
        //     player.setVelocityX(0);
        //     // player2.setVelocityX(0);
        //     player.anims.play('neutralPacman');
        //
        //     // player2.anims.play('pac');
        // }
        //
        // if (cursors.up.isDown && player.body.touching.down) {
        //     player.setVelocityY(-330);
        // }


        // const tmp = allPlayers[userId]
        // // initial empty because websocket is requesting info
        // if (tmp === undefined) {
        //     console.log('waiting for player info')
        //     return
        // }

        // let spriteId = allPlayers[userId].spriteType
        //
        // if (cursors.left.isDown) {
        //     playerSprites[spriteId].setVelocityX(-160);
        // } else if (cursors.right.isDown) {
        //     playerSprites[spriteId].setVelocityX(160);
        // } else if (cursors.up.isDown) {
        //     playerSprites[spriteId].setVelocityY(-160);
        // } else if (cursors.down.isDown) {
        //     playerSprites[spriteId].setVelocityY(160);
        // } else {
        //     playerSprites[spriteId].setVelocityY(0);
        //     playerSprites[spriteId].setVelocityX(0);
        // }
        //
        // allPlayers[userId].x = playerSprites[spriteId].x
        // allPlayers[userId].y = playerSprites[spriteId].y
        //
        // socket.emit('pos', JSON.stringify(allPlayers[userId]))
    }

</script>

<div id="thegame"></div>

</body>
</html>`